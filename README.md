```
â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘       â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘ â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘       â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘
â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘             â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘                    â–‘â–’â–“â–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘
 â–‘â–’â–“â–ˆâ–“â–’â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘             â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘                    â–‘â–’â–“â–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘
 â–‘â–’â–“â–ˆâ–“â–’â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘        â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘        â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘       â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘
  â–‘â–’â–“â–ˆâ–“â–“â–ˆâ–“â–’â–‘ â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘             â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–“â–’â–‘             â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘
  â–‘â–’â–“â–ˆâ–“â–“â–ˆâ–“â–’â–‘ â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘             â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–“â–’â–‘      â–‘â–’â–“â–ˆâ–ˆâ–“â–’â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’â–‘
   â–‘â–’â–“â–ˆâ–ˆâ–“â–’â–‘  â–‘â–’â–“â–ˆâ–“â–’â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘       â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘       â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–“â–ˆâ–ˆâ–“â–’â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘
```

# OS 2.1: Context-Aware, Memory-Persistent Orchestration for Claude Code

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚   Vibe Coding with High Quality Results and Outputs            â”‚
â”‚                                                                â”‚
â”‚   â€¢ Context & Memory-First Architecture                        â”‚
â”‚   â€¢ Introspective Response Awareness                           â”‚
â”‚   â€¢ Evidence-Based Completion with Quality Gates               â”‚
â”‚   â€¢ Multi-Agent Orchestration (Role Boundaries Enforced)       â”‚
â”‚   â€¢ Domain-Specific Pipelines with Phase Management            â”‚
â”‚   â€¢ Continuous Improvement via Meta-Audit                      â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Version:** 2.1 (November 2024)
**New in 2.1:** Unified planning (`/plan`), meta-audit (`/audit`), strict role boundaries, team confirmation, state preservation across interruptions

---

## What Is This?

**Vibe OS 2.1** is a disciplined orchestration system for Claude Code that fixes the fundamental problems of generic AI assistants:

- âŒ **Memory loss** â†’ âœ… Persistent knowledge graph (decisions, standards, failures)
- âŒ **Context thrashing** â†’ âœ… Intelligent context bundles (ProjectContext MCP)
- âŒ **False completion** â†’ âœ… Evidence-based verification (meta-tags + proof)
- âŒ **Scope drift** â†’ âœ… Role boundaries + quality gates (â‰¥90 scores to pass)
- âŒ **Agent amnesia** â†’ âœ… State preservation (phase_state.json + session continuity)

**The core innovation:** Orchestrators NEVER write code. They only coordinate specialized agents via the Task tool, making role boundaries explicit and preventing the system from "taking over" during interruptions.

---

## The Problem This Solves

**Claude Code is extremely powerful but has the memory of a goldfish and breaks orchestration easily.**

**Generic AI assistants:**
- Start from zero every session
- Say "done" when code doesn't compile
- Forget constraints mid-task
- Hallucinate design systems
- Abandon orchestration when you ask a question

**OS 2.1 enforces discipline:**
- Projects are indexed with **persistent context** (vectors + semantic search)
- **Pure orchestration layer** (only coordinates, never codes)
- **Role boundaries** explicitly enforced (orchestrators vs specialists)
- **Memory persists** across sessions (Workshop knowledge graph)
- **Quality gates** catch issues before humans see them (standards â‰¥90, design QA â‰¥90, a11y, performance)
- **State preservation** maintains orchestration across interruptions
- Work isn't "done" until there's **evidence** (tests, builds, screenshots, logs)

---

## System Architecture: OS 2.1

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         VIBE CODE OS 2.1                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Commands   â”‚      â”‚   Agents     â”‚      â”‚     MCPs     â”‚  â”‚
â”‚  â”‚  (/plan,     â”‚â—„â”€â”€â”€â”€â–ºâ”‚ (Specialized â”‚â—„â”€â”€â”€â”€â–ºâ”‚ (ProjectCtx, â”‚  â”‚
â”‚  â”‚   /orca-*,   â”‚      â”‚  Workers)    â”‚      â”‚  SharedCtx,  â”‚  â”‚
â”‚  â”‚   /audit)    â”‚      â”‚              â”‚      â”‚  Workshop)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                     â”‚                     â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                       â”‚                                        â”‚
â”‚                       â–¼                                        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚         â”‚   Orchestration Layer       â”‚                        â”‚
â”‚         â”‚  â€¢ Domain routing           â”‚                        â”‚
â”‚         â”‚  â€¢ Agent coordination       â”‚                        â”‚
â”‚         â”‚  â€¢ Role boundary enforce    â”‚                        â”‚
â”‚         â”‚  â€¢ Gate enforcement         â”‚                        â”‚
â”‚         â”‚  â€¢ State management         â”‚                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                       â”‚                                        â”‚
â”‚                       â–¼                                        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚         â”‚   Memory & Context Layer    â”‚                        â”‚
â”‚         â”‚  â€¢ ProjectContext (bundles) â”‚                        â”‚
â”‚         â”‚  â€¢ SharedContext (sessions) â”‚                        â”‚
â”‚         â”‚  â€¢ Workshop (knowledge)     â”‚                        â”‚
â”‚         â”‚  â€¢ Design DNA (standards)   â”‚                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## New in OS 2.1 (November 2024)

### 1. Unified Planning Command
**Old (OS 2.0):**
```bash
/requirements-start â†’ /requirements-status â†’ /response-awareness-plan
```

**New (OS 2.1):**
```bash
/plan "feature description"
```

- **Combines** requirements gathering + Response Awareness into ONE command
- **Produces** blueprint-quality spec at `requirements/<id>/06-requirements-spec.md`
- **Uses** AskUserQuestion tool for interactive Q&A (no more scrolling hell)
- **Never implements** - only plans

### 2. Meta-Audit Command
```bash
/audit "last 10 tasks"
```

- **Analyzes** recent agent behavior using Response Awareness lens
- **Creates** standards from failures
- **Enables** continuous improvement loop
- **Records** learnings to ProjectContext

### 3. Role Boundary Enforcement

**Every orca command now has:**
```markdown
## ğŸš¨ CRITICAL ROLE BOUNDARY ğŸš¨

YOU ARE AN ORCHESTRATOR. YOU NEVER WRITE CODE.

If you find yourself about to use Edit/Write tools: STOP. You've broken role.
Your only job: coordinate agents via Task tool. That's it.
```

**Fixes the problem:** When you interrupt with a question, Claude no longer abandons orchestration and starts coding directly.

### 4. State Preservation & Session Continuity

**Every orca command includes:**
- Instructions to read `phase_state.json` after interruptions
- "DO NOT ABANDON THE PIPELINE" directive
- Phase-specific resumption guide
- Anti-pattern detection with examples

**Result:** Orchestration survives across:
- User questions
- Clarifications
- Test results
- Pauses for review

### 5. Team Confirmation (AskUserQuestion)

**Before activating any pipeline:**
```typescript
AskUserQuestion({
  questions: [{
    question: "I detect this as a [domain] task. Proposed agents: [list]. Proceed?",
    options: [
      {label: "Proceed as planned", description: "..."},
      {label: "Adjust domain", description: "..."},
      {label: "Modify agents", description: "..."}
    ]
  }]
})
```

**Benefits:**
- No surprise agent teams
- User controls scope
- Interactive UI (no text-based Q&A)

---

## Request Flow: OS 2.1 Workflow

```
User Request
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: PLANNING (/plan)                                 â”‚
â”‚ â€¢ Requirements gathering (5 discovery + 5 detail Q&A)     â”‚
â”‚ â€¢ Response Awareness tagging (#PATH_DECISION, etc.)       â”‚
â”‚ â€¢ Blueprint generation (06-requirements-spec.md)          â”‚
â”‚ â€¢ Context query (ProjectContextServer - MANDATORY)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: ORCHESTRATION (/orca-nextjs|ios|expo|data)      â”‚
â”‚ â€¢ Context query (MANDATORY - loads relevant files)        â”‚
â”‚ â€¢ Team confirmation (AskUserQuestion)                     â”‚
â”‚ â€¢ Grand Architect (Opus - architecture & planning)        â”‚
â”‚ â€¢ Agent delegation (Sonnet specialists)                   â”‚
â”‚ â€¢ Gate enforcement (standards â‰¥90, design QA â‰¥90, etc.)   â”‚
â”‚ â€¢ State tracking (phase_state.json)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: META-AUDIT (/audit)                             â”‚
â”‚ â€¢ Behavior analysis across recent tasks                   â”‚
â”‚ â€¢ Standard creation from failures                         â”‚
â”‚ â€¢ Continuous improvement                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Domain Pipelines: Specialized Workflows

OS 2.1 includes **6 mature domain pipelines:**

### iOS Pipeline
- **Grand Architect** (Opus) - Architecture planning
- **Architect** (Sonnet) - Implementation planning
- **Builder** (Sonnet) - Implementation
- **8 Specialists** - SwiftUI, UIKit, persistence, networking, testing, performance, security, accessibility
- **4 Gates** - Architecture, standards â‰¥90, UI/interaction â‰¥90, build/test
- **Verification Agent** - Build/test evidence

### Next.js Pipeline
- **Grand Architect** (Opus) - Coordination & architecture
- **Architect** (Sonnet) - Planning
- **Layout Analyzer** (Sonnet) - Structure analysis
- **Builder** (Sonnet) - Implementation
- **5 Specialists** - TypeScript, Tailwind, layout, performance, accessibility
- **4 Gates** - Customization (design-dna), standards â‰¥90, design QA â‰¥90, build
- **Verification Agent** - Build/test/lint

### Expo Pipeline
- **Grand Orchestrator** (Opus) - For complex/high-risk work
- **Architect** (Sonnet) - Planning
- **Builder** (Sonnet) - Implementation
- **5 Gates** - Design tokens, a11y, aesthetics (soft), performance budgets, security
- **Verification Agent** - Build/test/expo doctor

### Data Pipeline
- **Researcher** - Discovery
- **4 Analysts** - Parallel analysis by specialization
- **3 Gates** - Data quality, verification, narrative coherence

### Design Pipeline
- **Design System Architect** - Token/component design
- **1 Gate** - Design QA review

### SEO Pipeline
- **Research Specialist** - SERP intelligence
- **Brief Strategist** - Content briefs
- **Draft Writer** - Long-form SEO content
- **Quality Guardian** - Compliance & clarity

**Total:** 50+ active agents across 6 domains

---

## Command Reference

### Active Commands (OS 2.1)

**Planning:**
- `/plan` - Unified requirements + RA blueprint (replaces 8+ commands)

**Orchestration:**
- `/orca` - Pure router (detects domain, delegates to lane)
- `/orca-nextjs` - Next.js lane orchestrator
- `/orca-ios` - iOS lane orchestrator
- `/orca-expo` - Expo/React Native lane orchestrator
- `/orca-data` - Data/analytics lane orchestrator

**Meta-Audit:**
- `/audit` - Response-aware behavior review

**Utilities:**
- `/enhance` - Transform vague requests into well-structured prompts
- `/ultra-think` - Deep multi-dimensional analysis
- `/session-save` / `/session-resume` - Manual session context control
- `/design-dna` - Initialize/update project design system
- `/seo` - SEO content pipeline
- `/clone-website` - Clone website UI into OS 2.0 project

### Deprecated (Backward Compatible)
- `/requirements-{start,status,end,current,list,remind}` â†’ Use `/plan`
- `/response-awareness-{plan,implement}` â†’ Use `/plan` + `/orca-{domain}`

---

## Memory & Context: Three-Layer System

### 1. ProjectContext MCP (Intelligent Context Bundles)

**What it does:**
- Returns relevant files for any task (semantic search via vectors)
- Provides project structure, decisions, standards, task history
- Prevents "let me read your entire codebase" waste

**Usage:**
```typescript
mcp__project-context__query_context({
  domain: "nextjs",
  task: "Add dark mode",
  projectPath: "/path/to/project",
  maxFiles: 10,
  includeHistory: true
})
```

**Returns:**
- Relevant files (semantically matched)
- Past decisions (from Workshop)
- Standards (learned rules)
- Similar tasks (history)
- Dependencies (what's connected)

### 2. SharedContext MCP (Cross-Session State)

**What it does:**
- Maintains context across sessions
- Compression (40-50% token reduction)
- Differential updates (only send changes)
- Versioned context

**Usage:**
```typescript
mcp__shared-context__get_shared_context({projectId: "/path"})
mcp__shared-context__update_shared_context({projectId: "/path", context: {...}})
```

### 3. Workshop Memory (Knowledge Graph)

**What it does:**
- Stores decisions, gotchas, goals, antipatterns
- Queryable via semantic (vectors) and keyword (FTS5) search
- Persists in `.claude/memory/workshop.db`

**Usage:**
```bash
workshop decision "Use Supabase for auth" -r "Team expertise + cost"
workshop gotcha "iOS Simulator needs Xcode 15.4+" -t ios -t xcode
workshop why "auth approach"
workshop search "CSS patterns"
```

---

## Quality Gates: Enforcement

All pipelines include numerical quality gates:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  QUALITY GATES (Numerical Scores, â‰¥90 to Pass)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  Standards Gate (standards-enforcer)                           â”‚
â”‚  âœ“ Design token usage (no magic numbers)                      â”‚
â”‚  âœ“ No inline styles                                           â”‚
â”‚  âœ“ Code quality (types, linting, formatting)                  â”‚
â”‚  âœ“ Score: 0-100 (â‰¥90 to pass)                                 â”‚
â”‚                                                                â”‚
â”‚  Design QA Gate (design-reviewer)                             â”‚
â”‚  âœ“ Grid compliance (4px/8px/16px/24px/32px)                   â”‚
â”‚  âœ“ Token-based styling                                        â”‚
â”‚  âœ“ Interaction states (hover, focus, active, disabled)        â”‚
â”‚  âœ“ Score: 0-100 (â‰¥90 to pass)                                 â”‚
â”‚                                                                â”‚
â”‚  Accessibility Gate (a11y-enforcer)                           â”‚
â”‚  âœ“ ARIA labels, semantic HTML                                 â”‚
â”‚  âœ“ Keyboard navigation                                        â”‚
â”‚  âœ“ Color contrast (WCAG AA)                                   â”‚
â”‚  âœ“ Score: 0-100 (â‰¥90 to pass)                                 â”‚
â”‚                                                                â”‚
â”‚  Performance Gate (performance-enforcer)                       â”‚
â”‚  âœ“ Bundle size budgets                                        â”‚
â”‚  âœ“ No heavy imports                                           â”‚
â”‚  âœ“ Render performance                                         â”‚
â”‚  âœ“ Score: 0-100 (â‰¥90 to pass)                                 â”‚
â”‚                                                                â”‚
â”‚  Build/Test Gate (verification-agent)                         â”‚
â”‚  âœ“ npm run build (success)                                    â”‚
â”‚  âœ“ Tests pass                                                 â”‚
â”‚  âœ“ No console errors                                          â”‚
â”‚  âœ“ Evidence captured (logs, screenshots)                      â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Usage Examples

### Full Implementation Workflow
```bash
# 1. Plan the work (creates requirements/<id>/06-requirements-spec.md)
/plan "Add user profile editing"

# 2. Implement via domain orchestrator
/orca-nextjs "Implement requirement <id> using that spec"

# 3. Later: Audit behavior
/audit "last 10 tasks"
```

### iOS Feature Implementation
```bash
/plan "Add biometric authentication"
/orca-ios "Implement requirement <id> using spec"
```

### Data Analysis
```bash
/plan "Analyze Q4 sales performance"
/orca-data "Implement requirement <id> using spec"
```

### Design System Updates
```bash
/design-dna init              # First-time setup
/design-dna audit            # Check current state
/design-dna generate "spacing"  # Generate new tokens
```

---

## File Organization

```
project-root/
â”œâ”€â”€ .claude/
â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â””â”€â”€ workshop.db              â† Per-project knowledge graph
â”‚   â”œâ”€â”€ orchestration/
â”‚   â”‚   â”œâ”€â”€ evidence/                â† FINAL artifacts (screenshots, reports)
â”‚   â”‚   â”œâ”€â”€ temp/                    â† Working files (DELETE after session)
â”‚   â”‚   â”œâ”€â”€ playbooks/               â† Reference patterns
â”‚   â”‚   â””â”€â”€ reference/               â† Key docs
â”‚   â”œâ”€â”€ project/
â”‚   â”‚   â””â”€â”€ phase_state.json         â† Current pipeline state
â”‚   â””â”€â”€ hooks/
â”‚       â””â”€â”€ session-start.sh         â† Auto-loads context
â”‚
â”œâ”€â”€ requirements/                     â† Planning artifacts (/plan)
â”‚   â”œâ”€â”€ .current-requirement
â”‚   â”œâ”€â”€ index.md
â”‚   â””â”€â”€ YYYY-MM-DD-HHMM-slug/
â”‚       â”œâ”€â”€ 00-initial-request.md
â”‚       â”œâ”€â”€ 01-discovery-questions.md
â”‚       â”œâ”€â”€ 02-discovery-answers.md
â”‚       â”œâ”€â”€ 03-context-findings.md
â”‚       â”œâ”€â”€ 04-detail-questions.md
â”‚       â”œâ”€â”€ 05-detail-answers.md
â”‚       â””â”€â”€ 06-requirements-spec.md   â† Blueprint for /orca-*
â”‚
â”œâ”€â”€ CLAUDE.md                         â† Project-specific instructions
â””â”€â”€ (source code...)

~/.claude/ (Global OS)
â”œâ”€â”€ commands/                         â† Live slash commands
â”‚   â”œâ”€â”€ plan.md
â”‚   â”œâ”€â”€ audit.md
â”‚   â”œâ”€â”€ orca.md
â”‚   â”œâ”€â”€ orca-nextjs.md
â”‚   â”œâ”€â”€ orca-ios.md
â”‚   â”œâ”€â”€ orca-expo.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ agents/                           â† Custom agent definitions
â”‚   â”œâ”€â”€ iOS/
â”‚   â”œâ”€â”€ nextjs/
â”‚   â”œâ”€â”€ expo/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ mcp/
â”‚   â”œâ”€â”€ project-context/              â† Context bundling
â”‚   â”œâ”€â”€ shared-context/               â† Session state
â”‚   â””â”€â”€ vibe-memory/                  â† Workshop integration
â””â”€â”€ CLAUDE.md                         â† Global instructions
```

---

## Getting Started

### 1. Install Prerequisites
```bash
# Workshop CLI (memory system)
cargo install workshop-cli

# Install Claude Code
# Follow: https://docs.anthropic.com/claude-code
```

### 2. Initialize Project
```bash
cd your-project

# Initialize Workshop memory
workshop init
mkdir -p .claude/memory
mv .workshop/workshop.db .claude/memory/workshop.db

# Create orchestration structure
mkdir -p .claude/orchestration/{evidence,temp,playbooks,reference}
mkdir -p .claude/project

# Create project instructions
cat > CLAUDE.md << 'EOF'
# Project: Your Project Name

## Stack
- Next.js 14 (App Router)
- Tailwind CSS
- shadcn/ui components

## Design System
See `.claude/design-dna/tokens.json`

## Standards
- Use design tokens exclusively
- No inline styles
- All spacing from 4px grid
EOF
```

### 3. Configure MCPs

Add to `~/.claude.json`:
```json
{
  "mcpServers": {
    "project-context": {
      "command": "node",
      "args": ["/path/to/.claude/mcp/project-context/dist/index.js"]
    },
    "shared-context": {
      "command": "node",
      "args": ["/path/to/.claude/mcp/shared-context/dist/index.js"]
    },
    "vibe-memory": {
      "command": "python3",
      "args": ["/path/to/.claude/mcp/vibe-memory/memory_server.py"],
      "env": {"PYTHONUNBUFFERED": "1"}
    }
  }
}
```

### 4. Index Your Project
```bash
# In Claude Code session:
mcp__project-context__index_project()
```

### 5. Start Using OS 2.1
```bash
# Plan work
/plan "Add dark mode support"

# Implement
/orca-nextjs "Implement requirement <id> using spec"

# Audit behavior
/audit "last 5 tasks"
```

---

## Documentation Structure

```
/
â”œâ”€â”€ README.md                        â† You are here (OS 2.1 overview)
â”œâ”€â”€ quick-reference/
â”‚   â”œâ”€â”€ commands.md                  â† Command reference
â”‚   â”œâ”€â”€ agents.md                    â† Agent teams
â”‚   â”œâ”€â”€ os2-pipelines.md             â† Domain pipelines
â”‚   â””â”€â”€ memory.md                    â† Memory system
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ pipelines/                   â† Pipeline specifications
â”‚   â”‚   â”œâ”€â”€ nextjs-pipeline.md
â”‚   â”‚   â”œâ”€â”€ ios-pipeline.md
â”‚   â”‚   â”œâ”€â”€ expo-pipeline.md
â”‚   â”‚   â””â”€â”€ data-pipeline.md
â”‚   â”œâ”€â”€ reference/                   â† Reference docs
â”‚   â”‚   â”œâ”€â”€ response-awareness.md
â”‚   â”‚   â”œâ”€â”€ quality-gates.md
â”‚   â”‚   â””â”€â”€ phase-configs/
â”‚   â”œâ”€â”€ architecture/                â† Architecture docs
â”‚   â””â”€â”€ memory/                      â† Memory system docs
â”œâ”€â”€ commands/                        â† Slash command definitions
â”œâ”€â”€ agents/                          â† Agent definitions
â”œâ”€â”€ mcp/                             â† Custom MCP servers
â””â”€â”€ scripts/                         â† Helper scripts
```

---

## Philosophy: Why This Exists

**Generic AI assistants are helpful but undisciplined.** They drift from requirements, hallucinate constraints, say "done" when reality disagrees, and abandon orchestration when interrupted.

**OS 2.1 treats Claude Code as a disciplined operating system:**
- **Commands** are system calls (orchestrators with role boundaries)
- **Agents** are processes (constrained, observable, specialized)
- **MCPs** are I/O interfaces (structured, permission-bounded)
- **Memory** is persistent state (queryable knowledge graph)
- **Verification** is syscall validation (evidence required)
- **State** is preserved across interruptions (phase_state.json)

**The result:** A disciplined, evidence-driven development system that produces reliable outputs, learns from failures, and maintains orchestration across the entire task lifecycle.

---

## Design Principles

### 1. Context-First Architecture
Every operation starts with ProjectContextServer query. No more "let me read your codebase."

### 2. Role Boundaries Are Sacred
Orchestrators coordinate. Specialists implement. Never both.

### 3. Evidence-Based Completion
Work is "done" when evidence exists: tests pass, builds succeed, screenshots captured.

### 4. State Preservation
Orchestration persists across interruptions. User questions don't reset roles.

### 5. Quality Gates Are Mandatory
Standards â‰¥90, design QA â‰¥90, tests pass. No exceptions.

### 6. Memory Is Ground Truth
Decisions live in Workshop, not ephemeral chat. Design DNA is versioned.

### 7. Calculate, Don't Guess
Spacing, typography, layout follow mathematical systems. No arbitrary values.

---

## What's Next?

**OS 2.1 focuses on:**
- âœ… Unified planning workflow
- âœ… Meta-audit for continuous improvement
- âœ… Role boundary enforcement
- âœ… State preservation across interruptions
- âœ… Team confirmation before execution

**Future directions:**
- Advanced parallel planning strategies
- Cross-domain handoff improvements
- Enhanced meta-learning from audits
- Tighter integration with external design tools

---

## Contributing

This is a personal framework that evolved through real-world usage. The patterns are generalizable:

- **Share agent definitions** that worked for you
- **Document failures** (antipatterns matter)
- **Contribute to MCPs** (project-context, shared-context, vibe-memory)
- **Refine pipelines** with your domain expertise

---

## License

MIT

---

**Build right first. Verify with evidence. Learn from memory. Maintain orchestration.**
