/opt/homebrew/Library/Homebrew/cmd/shellenv.sh: line 18: /bin/ps: Operation not permitted
# OS-Dev Pipeline Phase Configuration - OS 2.3
# OS / Claude Code / Tooling Configuration Workflow
#
# NOTE: This pipeline is LOCAL to claude-vibe-config repo only.
# It is NOT deployed to ~/.claude global config.

pipeline:
  name: os-dev
  description: OS 2.x / Claude Code configuration and orchestration pipeline
  version: 2.3

context:
  provider: ProjectContextServer
  required: true
  query_on_start: true
  memory_first: true      # Check Workshop/vibe.db before ProjectContext

phases:
  - name: intake
    agent: os-dev-grand-architect
    description: Initial classification of task and complexity tier
    context_required: false
    outputs:
      - task_summary
      - complexity_tier
      - initial_risks

  - name: context_query
    agent: os-dev-grand-architect
    description: Memory-first context and ProjectContext query
    context_required: false
    outputs:
      - memory_summary
      - context_bundle_summary

  - name: planning
    agent: os-dev-architect
    description: Plan and constraints for OS-Dev change
    dependencies:
      - intake
      - context_query
    context_required: true
    inputs:
      - complexity_tier
      - memory_summary
      - context_bundle
    outputs:
      - plan_summary
      - files_targeted
      - change_type
      - risk_assessment
      - ra_events

  - name: implementation_pass1
    agent: os-dev-builder
    description: Primary implementation of planned OS-Dev change
    dependencies:
      - planning
    context_required: true
    inputs:
      - plan_summary
      - files_targeted
    outputs:
      - files_modified
      - changes_manifest
      - rollback_notes
      - ra_events
    constraints:
      scope: Edit-not-rewrite, minimal diffs in allowed config surfaces
      resource: Single coherent diff per pass

  - name: os_dev_standards_gate
    agent: os-dev-standards-enforcer
    description: Standards and safety verification for OS-Dev changes
    dependencies:
      - implementation_pass1
    context_required: true
    inputs:
      - files_modified
      - changes_manifest
      - related_standards
    outputs:
      - standards_score
      - gate_decision
      - violations
      - ra_status
    quality_gates:
      standards_score:
        threshold: 90
        type: hard_block
        message: OS-Dev standards score must be â‰¥90

  - name: implementation_pass2
    agent: os-dev-builder
    description: Corrective implementation for gate failures
    dependencies:
      - os_dev_standards_gate
    condition: any_gate_failed
    context_required: true
    inputs:
      - violations
    outputs:
      - files_modified
      - fixes_applied
    constraints:
      scope: Fix gate violations only, no new features

  - name: verification
    agent: os-dev-verification
    description: Syntax and smoke-test verification
    dependencies:
      - os_dev_standards_gate
    context_required: false
    outputs:
      - verification_status
      - commands_run
      - errors

optional_phases: []

memory:
  persistent: vibe.db
  learnings:
    - os_dev_standards
    - prior_incidents
    - lane_patterns

success:
  all_gates_pass: true
  standards_score_min: 90

phase_state:
  location: ".claude/orchestration/phase_state.json"
  domain: "os-dev"

  top_level_fields:
    - requirement_id
    - requirements_spec_path
    - complexity_tier

  phase_entries:
    intake:
      description: "Initial task summary and complexity classification"
      fields:
        - task_summary
        - complexity_tier
        - initial_risks

    context_query:
      description: "Memory-first and ProjectContext query results"
      fields:
        - memory_summary
        - context_bundle_summary

    planning:
      description: "Plan and constraints for OS-Dev change"
      fields:
        - plan_summary
        - files_targeted
        - change_type
        - risk_assessment
        - ra_events

    implementation_pass1:
      description: "First implementation pass for OS-Dev change"
      fields:
        - files_modified
        - changes_manifest
        - rollback_notes
        - ra_events

    os_dev_standards_gate:
      description: "OS-Dev standards and safety gate"
      fields:
        - standards_score
        - gate_decision
        - violations
        - ra_status

    implementation_pass2:
      description: "Corrective implementation for OS-Dev gate failures"
      fields:
        - files_modified
        - fixes_applied

    verification:
      description: "Verification of OS-Dev changes"
      fields:
        - verification_status
        - commands_run
        - errors

